# LLL-Inplace.jl

(以下Gemini要約)

Juliaの標準的な `BigFloat` 演算は計算のたびに新しいオブジェクトを生成するため、LLLアルゴリズムのような反復計算ではGC（ガベージコレクション）がボトルネックになります。

この実装は、`libmpfr` と `libgmp` の関数を `ccall` で直接叩き、メモリを破壊的に再利用（In-place mutation）することで、GCのオーバーヘッドを極限まで排除した爆速のLLL実装です。

## 特徴
- **Zero-allocation loop**: メインループ内での新規メモリ確保を回避。
- **Direct MPFR/GMP calls**: Juliaのオーバーヘッドを通さず、Cレイヤーで計算。
- **Performance**: 標準的な実装に比べ、大幅な高速化を実現。

## 使い方
`LLL5.jl` を作業ディレクトリにコピー、その後 include して `LLL5` 関数を呼び出してください。

```julia
include("LLL5.jl")

# x: 入力ベクトル, C: 拡大係数
# b_int: 縮小基底（整数行列）, b_real: 実数残差, iter: 反復回数
b_int, b_real, iter = LLL5(x, C)
```

## 例
```julia
julia> include("LLL5.jl")
LLL5 (generic function with 3 methods)

julia> x = rand(BigFloat,15)
15-element Vector{BigFloat}:
 0.4060882708418911160427444708320559913002916875334932378992915005488427727884325
 0.8314572129335198379704156400456420975342832441956316019963500164598843342758815
 0.7205413360871184606200653292023528523404185510119258534199331789604766026829125
 0.9332997643469809302421869377085494136345127784194499338649568685568033260805188
 0.310851935994490025750351084229121841175552856779085083724802021891023981948955
 0.6633853181751877168144316032580929637088032816409565628695325468141911612188076
 0.5831820309012652301742910014011745223865028384442782471023631150728831506364062
 0.1994842994520834107693108034278417618207802233785390974132852683915895576200514
 0.3397862505486173936333804586652742976843590521493233181929946201160958488550434
 0.5563024968630402450099342979554571229598193267737435680948159478030603097899846
 0.2502412399348247807029453726359305334203481294117486952320590626499167499306824
 0.7157765916389614248906009653660945672449844194068024336945188379370182359521876
 0.7948789326056002179246180767488204107079106219743688107711193370986839623161429
 0.3831489168055023716981513498768066297159285634940925085715383340390477471161894
 0.6020973223321588684201366851770407695512163697055785193466549790030500181228379

julia> C = big(10)^38
100000000000000000000000000000000000000

julia> LLL5(x,C)
(BigInt[-60 175 … -7 -58; -142 -5 … -110 4; … ; 233 103 … -57 -141; 28 6 … 116 -89], BigFloat[81.18158295866921975554155481627952238897228795509812995772572024325503102823645, 255.9452798030418390163541480310729795929799936669773375976379217406503765630287, 4.23111722293526026881586953130148555574277585251937902829591710284978698417315, 216.6730432999130485381131556919879748713213037892194570035464566040788986861292, -123.8071410183431570142391377347132633264342804120008506432394658535673470249174, 45.28571895253850835649982037578139626721714939358558139612941254040602951963831, -19.96844108572577887082010327968040208518952737267523564500123278349194859879672, 45.09358463715416704689091769046487233528074660146590102451886448635155600907484, -206.5846152423696869324171674391497099484145143538872627635888434946020209500401, 67.62184292895089103950899403971336300950715799583798168866408189101826207306028, -179.5046823720075564681578440732238782297053230800246301081182900172963202166883, -180.9120233025623496810070613845448367574368034840766204925049563109890113706435, -141.3083133039930867063648454254026476460032307491115709194070445898571956642914, -101.5821558238447217357932438366577806269300729942847353068758389374779564199898, -192.2167244648194541686676633894274698736542835943898946834988568459838854471882], 1704)

julia>
```
